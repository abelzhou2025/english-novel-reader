<!DOCTYPE html>

<html lang="zh">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Why does AI keep making things up that aren't true? - English Novel Reader</title>
<link href="../styles.css" rel="stylesheet"/>
<style>
        body {
            font-family: Georgia, serif;
            background-color: #f9f7f4;
            margin: 0;
            padding: 0;
        }
        
        .article-content {
            max-width: 900px;
            margin: 100px auto 50px;
            padding: 40px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .back-btn {
            display: inline-block;
            background-color: #5a3e2b;
            color: #fff;
            padding: 10px 20px;
            border-radius: 6px;
            text-decoration: none;
            font-family: 'Microsoft YaHei', sans-serif;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            margin-bottom: 30px;
        }
        
        .back-btn:hover {
            background-color: #7a5c42;
            transform: translateY(-2px);
        }
        
        .article-title {
            font-family: Georgia, serif;
            font-size: 2rem;
            color: #2c2c2c;
            margin-bottom: 30px;
            line-height: 1.3;
            font-weight: 600;
        }
        
        .article-section {
            margin-bottom: 30px;
        }
        
        .section-heading {
            font-family: Georgia, serif;
            font-size: 1.5rem;
            color: #3a3a3a;
            margin-top: 35px;
            margin-bottom: 20px;
            font-weight: 600;
            line-height: 1.4;
        }
        
        .section-subheading {
            font-family: Georgia, serif;
            font-size: 1.2rem;
            color: #4a4a4a;
            margin-top: 25px;
            margin-bottom: 15px;
            font-weight: 600;
            line-height: 1.4;
        }
        
        .paragraph-block {
            margin-bottom: 25px;
        }
        
        .english-text {
            font-family: Georgia, serif;
            font-size: 1.1rem;
            color: #2c2c2c;
            line-height: 1.8;
            margin-bottom: 12px;
        }
        
        .chinese-text {
            font-family: 'Microsoft YaHei', 'SimHei', sans-serif;
            font-size: 1rem;
            color: #666;
            line-height: 1.8;
            padding-left: 20px;
            border-left: 3px solid #d4a76a;
            opacity: 0.7;
        }
        
        @media (max-width: 768px) {
            .article-content {
                margin: 80px 15px 30px;
                padding: 25px;
            }
            
            .article-title {
                font-size: 1.6rem;
            }
            
            .section-heading {
                font-size: 1.3rem;
            }
            
            .english-text {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
<!-- Top Navigation -->
<nav class="top-nav">
<ul>
<li><a href="../index.html">首页</a></li>
<li><a href="../novels.html">小说</a></li>
<li><a class="active" href="../webnovels.html">网文</a></li>
    <li><a href="../news.html">新闻</a></li>
    <li><a href="../about.html">关于我</a></li>
</ul>
</nav>
<div class="article-content">
<a class="back-btn" href="../webnovels.html">← 返回网文列表</a>
<h1 class="article-title">Why does AI keep making things up that aren't true?</h1>
<div class="paragraph-block">
<p class="english-text">www.sciencenorway.no (Photo: Matt Rourke, AP, NTB)</p>
<p class="chinese-text">www.sciencenorway.no（照片：Matt Rourke，美联社，NTB）</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">You may have experienced it yourself. Sometimes one of the large AI models gives you answers that appear to be correct.</p>
<p class="chinese-text">您可能亲身经历过。有时，大型人工智能模型之一会给出看似正确的答案。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">It may seem confident, but it can turn out to be completely made up.</p>
<p class="chinese-text">看似自信，但结果可能完全是装出来的。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">This is a fundamental problem in language models, and hallucinations continue to be an issue even in the most advanced models, according to an article written by several researchers at OpenAI, the company behind the most well-known language model, ChatGPT.</p>
<p class="chinese-text">根据 OpenAI（最著名的语言模型 ChatGPT 背后的公司）的几位研究人员撰写的一篇文章，这是语言模型中的一个基本问题，即使在最先进的模型中，幻觉仍然是一个问题。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">The article is available on the preprint archive Arxiv, but it has not been peer-reviewed.</p>
<p class="chinese-text">该文章可在预印本存档 Arxiv 上找到，但尚未经过同行评审。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">Still, it has sparked debate among researchers about how to handle uncertainty in language models, Erik Velldal tells Science Norway.</p>
<p class="chinese-text">埃里克·维尔达尔（Erik Velldal）告诉《挪威科学》杂志，尽管如此，它还是引发了研究人员关于如何处理语言模型中的不确定性的争论。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">Annonse</p>
<p class="chinese-text">安农斯</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">He is a professor at the University of Oslo's Department of Infomatics.</p>
<p class="chinese-text">他是奥斯陆大学信息学系教授。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">Another researcher believes that OpenAI's proposed solution could completely undermine people's relationship with these AI models. More on that later.</p>
<p class="chinese-text">另一位研究人员认为，OpenAI 提出的解决方案可能会完全破坏人们与这些人工智能模型的关系。稍后会详细介绍。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">But first -- how do these hallucinations actually happen? And what should the models do when they don't have a good answer to a question?</p>
<p class="chinese-text">但首先——这些幻觉实际上是如何发生的？当模型没有很好地回答问题时应该怎么办？</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">Erik Velldal, professor of informatics. (Photo: University of Oslo)</p>
<p class="chinese-text">埃里克·维尔达尔（Erik Velldal），信息学教授。（照片：奥斯陆大学）</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<h2 class="section-heading">"Things can go wrong"</h2>
<div class="paragraph-block">
<p class="english-text">Hallucinations are a completely normal part of how language models work, Velldal tells Science Norway.</p>
<p class="chinese-text">维尔达尔告诉《挪威科学》杂志，幻觉是语言模型工作中完全正常的一部分。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">"The models are probability distributions over sequences of words, not databases of facts about the world," he says.</p>
<p class="chinese-text">“这些模型是单词序列的概率分布，而不是世界事实的数据库，”他说。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">In other words, the sentences produced by models like ChatGPT are the result of probability calculations. Each word is chosen based on what's most likely to follow the previous one.</p>
<p class="chinese-text">换句话说，像ChatGPT这样的模型产生的句子是概率计算的结果。每个单词都是根据最有可能跟在前一个单词后面的单词来选择的。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">As a result, things can occasionally go off track.</p>
<p class="chinese-text">结果，事情有时会偏离轨道。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">"Things can go wrong, especially when it comes to topics that are poorly represented in their training data," says Velldal.</p>
<p class="chinese-text">“事情可能会出错，尤其是当涉及到训练数据中表现不佳的主题时，”Velldal 说。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">That's when models might start producing answers that sound plausible but aren't true. For example, fictional studies.</p>
<p class="chinese-text">那时模型可能会开始产生听起来似乎合理但实际上并不正确的答案。例如，虚构研究。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">"It can make up something that sounds likely, invent both titles and references that seem real. Maybe it even uses the names of real researchers as authors," he says.</p>
<p class="chinese-text">“它可以编造一些听起来很可能的东西，发明看起来真实的标题和参考文献。也许它甚至使用真正的研究人员的名字作为作者，”他说。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">The researchers behind the article note that during training, models are rewarded for guessing, but not for expressing uncertainty.</p>
<p class="chinese-text">文章背后的研究人员指出，在训练过程中，模型会因猜测而获得奖励，但不会因表达不确定性而获得奖励。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<h2 class="section-heading">Multiple choice</h2>
<div class="paragraph-block">
<p class="english-text">When AI models are trained, different types of tests are used to evaluate how good they are. These can also be multiple-choice-type tests where the models have clearly defined answer options to choose from.</p>
<p class="chinese-text">当训练人工智能模型时，会使用不同类型的测试来评估它们的性能。这些也可以是多项选择类型的测试，其中模型有明确定义的答案选项可供选择。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">Annonse</p>
<p class="chinese-text">安农斯</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">This can be compared to humans taking such tests, the researchers write in the article. It's better to guess, because then there's at least a chance to get it right.</p>
<p class="chinese-text">研究人员在文章中写道，这可以与人类进行此类测试进行比较。最好是猜测，因为这样至少有机会猜对。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">"The problem is that the model is not rewarded for acknowledging that there's something it doesn't know and therefore just guesses," says Velldal.</p>
<p class="chinese-text">“问题在于，模型不会因为承认有一些东西它不知道而只是猜测而得到奖励，”Velldal 说。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">The researchers suggest introducing an 'I don't know' option.</p>
<p class="chinese-text">研究人员建议引入“我不知道”选项。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<h3 class="section-subheading">Most viewed</h3>
<div class="paragraph-block">
<p class="english-text">#### Eight pages bound in furry seal skin may be Norway's oldest book
*</p>
<p class="chinese-text">#### 用毛茸茸的海豹皮装订的八页书可能是挪威最古老的书
*</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">#### Norwegian professor received death threats from Ethiopians in exile
*</p>
<p class="chinese-text">#### 挪威教授收到流亡埃塞俄比亚人的死亡威胁
*</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">#### World's oldest rune stone found in Norway, archaeologists believe
*</p>
<p class="chinese-text">#### 考古学家认为在挪威发现了世界上最古老的符文石
*</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">#### "They no longer knew their language, they spoke and dressed differently"
*</p>
<p class="chinese-text">####“他们不再懂得自己的语言，他们的说话和穿着都不同”
*</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">#### Did the Norwegians in America know that the land they were given had been stolen?</p>
<p class="chinese-text">#### 在美洲的挪威人知道他们获得的土地被偷了吗？</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">This would allow models to learn to express uncertainty rather than making things up. Velldal believes this could lead to fewer hallucinations -- if it becomes part of how models are evaluated during training.</p>
<p class="chinese-text">这将使模型能够学会表达不确定性而不是捏造事实。维尔达尔认为，如果它成为训练期间评估模型的一部分，这可能会减少幻觉。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">However, he adds that this approach might not easily apply to longer, open-ended tasks such as writing essays or summarising research.</p>
<p class="chinese-text">然而，他补充说，这种方法可能不容易适用于较长的、开放式的任务，例如撰写论文或总结研究。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">"When people ask models to summarise knowledge or write about a certain topic, it's much harder to see how that proposal would work," says Velldal.</p>
<p class="chinese-text">“当人们要求模型总结知识或撰写某个主题的文章时，很难看出该建议将如何发挥作用，”维尔达尔说。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<h2 class="section-heading">Still a persistent problem</h2>
<div class="paragraph-block">
<p class="english-text">Hallucinations remain an ongoing challenge.</p>
<p class="chinese-text">幻觉仍然是一个持续的挑战。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">A very recent example comes from the Norwegian Broadcasting Corporation NRK, which let language models answer news-related questions from public broadcaster websites.</p>
<p class="chinese-text">最近的一个例子来自挪威广播公司 NRK，该公司让语言模型回答来自公共广播网站的新闻相关问题。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">45 per cent of the answers contained significant errors, including made-up news articles with fake links,according to NRK (link in Norwegian).</p>
<p class="chinese-text">据 NRK（挪威语链接）称，45% 的答案包含重大错误，包括带有虚假链接的虚构新闻文章。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">Even so, Velldal says the situation has improved over the past year.</p>
<p class="chinese-text">即便如此，维尔达尔表示，过去一年情况有所改善。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">"That's mainly because language models are increasingly used in combination with internet searches and external tools. That helps ground the answers in real information," he says.</p>
<p class="chinese-text">“这主要是因为语言模型越来越多地与互联网搜索和外部工具结合使用。这有助于将答案建立在真实信息的基础上，”他说。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">But should the models get better at communicating uncertainty?</p>
<p class="chinese-text">但模型是否应该更好地传达不确定性？</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<h2 class="section-heading">"Users would likely abandon such systems"</h2>
<div class="paragraph-block">
<p class="english-text">One of OpenAI's proposed solutions is to have language models assess how confident they are in an answer before giving it, writes researcher Wei Xing in The Conversation.</p>
<p class="chinese-text">研究员 Wei Xing 在 The Conversation 中写道，OpenAI 提出的解决方案之一是让语言模型在给出答案之前评估它们对答案的信心。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">According to the data presented in the article, he argues this approach could result in a large language model beginning its responses with I don't know roughly one-third of the time.</p>
<p class="chinese-text">根据文章中提供的数据，他认为这种方法可能会导致大型语言模型在大约三分之一的情况下开始做出响应。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">"Users accustomed to receiving confident answers to virtually any question would likely abandon such systems rapidly," he believes.</p>
<p class="chinese-text">他认为，“习惯于对几乎所有问题获得自信答案的用户可能会迅速放弃此类系统。”</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">Velldal does not entirely agree.</p>
<p class="chinese-text">维尔达尔并不完全同意。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">"Of course, people want clear answers, but not if they're wrong. I'd prefer the model to admit it doesn't know, but it also shouldn't become overly cautious," he says.</p>
<p class="chinese-text">“当然，人们想要明确的答案，但如果他们错了就不需要。我更希望模型承认它不知道，但它也不应该变得过于谨慎，”他说。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">Velldal points out that a model that too often responds with 'I can't help you with that' out of fear of being wrong won't be very useful either.</p>
<p class="chinese-text">维尔达尔指出，如果一个模型经常因为担心出错而回答“我帮不了你”，那么它也不会很有用。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">Translated by Alette Bjordal Gjellesvik</p>
<p class="chinese-text">译者：Alette Bjordal Gjellesvik</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">Read the Norwegian version of this article on forskning.no</p>
<p class="chinese-text">在 forskning.no 上阅读本文的挪威语版本</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<h2 class="section-heading">What's best for the environment? ChatGPT or Google?](https://www.sciencenorway.no/artificial-intelligence-chatgpt-data/whats-best-for-the-environment-chatgpt-or-google/2515728) [UiT The Arctic University of Norway</h2>
<h2 class="section-heading">Why does Norway need its own AI law?](https://www.sciencenorway.no/artificial-intelligence-law-technology/why-does-norway-need-its-own-ai-law/2561733)</h2>
<div class="paragraph-block">
<p class="english-text">The latest news from Science Norway, sent twice a week and completely free.</p>
<p class="chinese-text">来自《挪威科学》的最新新闻，每周发送两次，完全免费。</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">Sign up</p>
<p class="chinese-text">报名</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
<div class="paragraph-block">
<p class="english-text">Read in Cubox</p>
<p class="chinese-text">在 Cubox 中阅读</p>
</div>
<div class="paragraph-block">

<p class="chinese-text">[翻译占位 - 翻译占位符]</p>
</div>
</div>

    <!-- Translation Tooltip HTML -->
    <div class="translation-tooltip" id="translationTooltip" style="display: none; position: fixed; max-width: 400px; background-color: rgba(255, 255, 255, 0.98); border: 2px solid #5a3e2b; border-radius: 8px; padding: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.2); z-index: 1000; font-family: 'Microsoft YaHei', sans-serif;">
        <div class="tooltip-translation" style="color: #5a3e2b; font-size: 1rem; font-weight: 500; line-height: 1.6;">翻译中...</div>
    </div>
    <!-- Translation Script -->
    <script>
        // Article Translation Features
        // Features: Click-to-translate near cursor
        
        // Global variables
        let selectedParagraph = null;
        
        // Translation API (using free MyMemory API)
        const TRANSLATION_API = 'https://api.mymemory.translated.net/get';
        
        // DOM elements
        let translationTooltip;
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Get DOM elements
            translationTooltip = document.getElementById('translationTooltip');
            
            // Add click listener to close tooltip when clicking outside
            document.addEventListener('click', function(e) {
                // Check if click is outside tooltip and not on a selectable paragraph
                if (translationTooltip && 
                    !translationTooltip.contains(e.target) && 
                    !e.target.classList.contains('selectable')) {
                    hideTranslation();
                }
            });
            
            // Add selectable class to all English text paragraphs in articles
            const englishParagraphs = document.querySelectorAll('.english-text');
            englishParagraphs.forEach(paragraph => {
                // Only make English text selectable
                if (paragraph.textContent.trim()) {
                    paragraph.classList.add('selectable');
                    
                    // Add click listener for translation
                    paragraph.addEventListener('click', function(e) {
                        e.stopPropagation(); // Prevent document click from firing
                        handleParagraphClick(this, e);
                    });
                }
            });
        });
        
        // Handle paragraph click for translation
        function handleParagraphClick(element, event) {
            // Remove previous selection
            if (selectedParagraph) {
                selectedParagraph.classList.remove('selected');
            }
            
            // Mark as selected
            element.classList.add('selected');
            selectedParagraph = element;
            
            // Get the text to translate
            const textToTranslate = element.textContent;
            
            // Position tooltip near the click
            positionTooltip(event);
            
            // Show tooltip with loading state
            showTranslation(textToTranslate);
            
            // Fetch translation
            translateText(textToTranslate);
        }
        
        // Position tooltip near cursor but ensure it stays on screen
        function positionTooltip(event) {
            const tooltip = translationTooltip;
            const offset = 15; // Offset from cursor
            
            // Get viewport dimensions
            const viewportWidth = window.innerWidth;
            const viewportHeight = window.innerHeight;
            
            // Initial position near cursor
            let left = event.pageX + offset;
            let top = event.pageY + offset;
            
            // Show tooltip temporarily to get its dimensions
            tooltip.style.display = 'block';
            tooltip.style.left = left + 'px';
            tooltip.style.top = top + 'px';
            
            // Get tooltip dimensions
            const tooltipRect = tooltip.getBoundingClientRect();
            const tooltipWidth = tooltipRect.width;
            const tooltipHeight = tooltipRect.height;
            
            // Adjust if tooltip goes off right edge
            if (event.clientX + tooltipWidth + offset > viewportWidth) {
                left = event.pageX - tooltipWidth - offset;
            }
            
            // Adjust if tooltip goes off bottom edge
            if (event.clientY + tooltipHeight + offset > viewportHeight) {
                top = event.pageY - tooltipHeight - offset;
            }
            
            // Ensure tooltip doesn't go off left or top edges
            if (left < 10) left = 10;
            if (top < 80) top = 80; // Account for top nav
            
            // Set final position
            tooltip.style.left = left + 'px';
            tooltip.style.top = top + 'px';
        }
        
        // Show translation tooltip
        function showTranslation(originalText) {
            const translationDiv = translationTooltip.querySelector('.tooltip-translation');
            
            // Show loading state
            translationDiv.textContent = '翻译中...';
            translationDiv.style.color = '#999';
            
            // Show tooltip
            translationTooltip.style.display = 'block';
        }
        
        // Hide translation tooltip
        function hideTranslation() {
            translationTooltip.style.display = 'none';
            if (selectedParagraph) {
                selectedParagraph.classList.remove('selected');
                selectedParagraph = null;
            }
        }
        
        // Translate text using free API
        async function translateText(text) {
            const translationDiv = translationTooltip.querySelector('.tooltip-translation');
            
            // Limit text length for API (MyMemory has a 500 character limit)
            const textToTranslate = text.length > 500 ? text.substring(0, 500) : text;
            
            // If text is too long, split it into chunks
            const maxChunkLength = 500; // MyMemory API limit
            
            if (text.length <= maxChunkLength) {
                // Short text - translate directly
                try {
                    const url = `${TRANSLATION_API}?q=${encodeURIComponent(text)}&langpair=en|zh-CN`;
                    const response = await fetch(url);
                    const data = await response.json();
                    
                    if (data.responseStatus === 200 && data.responseData) {
                        const translation = data.responseData.translatedText;
                        translationDiv.textContent = translation;
                        translationDiv.style.color = '#5a3e2b';
                    } else {
                        translationDiv.textContent = '翻译失败,请稍后重试';
                        translationDiv.style.color = '#d9534f';
                    }
                } catch (error) {
                    console.error('Translation error:', error);
                    translationDiv.textContent = '翻译服务暂时不可用';
                    translationDiv.style.color = '#d9534f';
                }
            } else {
                // Long text - split into chunks
                try {
                    // Split text into chunks of maxChunkLength, trying to break at sentence boundaries
                    const chunks = [];
                    let currentChunk = '';
                    
                    // First, try to split by sentence endings
                    const sentences = text.match(/[^.!?。！？]+[.!?。！？]*/g) || [text];
                    
                    for (const sentence of sentences) {
                        if ((currentChunk + sentence).length <= maxChunkLength) {
                            currentChunk += sentence;
                        } else {
                            if (currentChunk) {
                                chunks.push(currentChunk);
                            }
                            // If single sentence is too long, force split by maxChunkLength
                            if (sentence.length > maxChunkLength) {
                                for (let i = 0; i < sentence.length; i += maxChunkLength) {
                                    chunks.push(sentence.substring(i, i + maxChunkLength));
                                }
                                currentChunk = '';
                            } else {
                                currentChunk = sentence;
                            }
                        }
                    }
                    
                    if (currentChunk) {
                        chunks.push(currentChunk);
                    }
                    
                    // Translate each chunk
                    let fullTranslation = '';
                    for (let i = 0; i < chunks.length; i++) {
                        const chunk = chunks[i];
                        const url = `${TRANSLATION_API}?q=${encodeURIComponent(chunk)}&langpair=en|zh-CN`;
                        const response = await fetch(url);
                        const data = await response.json();
                        
                        if (data.responseStatus === 200 && data.responseData) {
                            fullTranslation += data.responseData.translatedText;
                            // Update display with progress
                            translationDiv.textContent = fullTranslation + ' [翻译中...]';
                        } else {
                            fullTranslation += '[翻译失败]';
                        }
                        
                        // Add small delay to avoid rate limiting
                        if (i < chunks.length - 1) {
                            await new Promise(resolve => setTimeout(resolve, 200));
                        }
                    }
                    
                    translationDiv.textContent = fullTranslation;
                    translationDiv.style.color = '#5a3e2b';
                } catch (error) {
                    console.error('Translation error:', error);
                    translationDiv.textContent = '翻译服务暂时不可用';
                    translationDiv.style.color = '#d9534f';
                }
            }
        }
        
        // Add CSS for selected state
        const style = document.createElement('style');
        style.textContent = `
            .selectable {
                cursor: pointer;
                transition: background-color 0.2s ease;
                padding: 2px 4px;
                border-radius: 3px;
            }
            
            .selectable:hover {
                background-color: rgba(212, 167, 106, 0.2);
            }
            
            .selectable.selected {
                background-color: rgba(212, 167, 106, 0.4);
            }
            
            .translation-tooltip {
                animation: fadeIn 0.2s ease;
            }
            
            @keyframes fadeIn {
                from {
                    opacity: 0;
                    transform: translateY(-5px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
        `;
        document.head.appendChild(style);
    </script>
    </body>
</html>